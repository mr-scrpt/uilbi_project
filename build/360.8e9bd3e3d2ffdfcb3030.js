"use strict";(self.webpackChunkproject=self.webpackChunkproject||[]).push([[360],{5056:(e,t,r)=>{r.r(t),r.d(t,{ArticlePage:()=>ae});var n=r(5893),a=r(7195),i=r(7294),o=r(2418),c=r(8608).p.injectEndpoints({endpoints:function(e){return{fetchArticleRecomended:e.query({query:function(e){return{url:"/articles",params:{_limit:e}}}})}}}).useFetchArticleRecomendedQuery;var s=(0,i.memo)((function(e){var t=e.className,r=(0,o.A)("hlKuF9",[t],{}),s=(0,o.A)("KZi_Iu",["D5NlpC"],{}),l=c(3),u=l.data,d=l.isLoading,f=l.error,m=(0,i.useCallback)((function(e){return(0,n.jsx)(a.bI,{view:a.Zx.TILE,className:s,article:e},e.id)}),[s]);return(0,n.jsx)(a.Uw,{className:r,articleList:u,error:f&&JSON.stringify(f),isLoading:d,renderFeed:m})})),l=r(467),u=r(1072),d=r(743),f=r(9250),m=r(2257),v=r(3390);var h=function(){return h=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},h.apply(this,arguments)},p=(0,i.memo)((function(e){var t=e.className,r=e.text,a=e.slug,i=(0,o.A)("ZNFLMM",[t],{}),c=(0,u.$G)().t,s="".concat(v.h3.article).concat(a,"/edit");return(0,n.jsx)(m.ud,h({className:i,to:s},{children:c(r)}))}));var x=function(){return x=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},x.apply(this,arguments)},j=(0,i.memo)((function(e){var t=e.className,r=e.text,a=(0,u.$G)().t,i=(0,o.A)("qEffPY",[t],{});return(0,n.jsx)(m.ud,x({className:i,to:v.h3.articleFeed},{children:a(r)}))})),y=(0,r(2222).P1)(a.D$,l.m5,(function(e,t){return!(!(null==e?void 0:e.user)||!t)&&(console.log("art user",e,t),e.user.id===t.id)}));var g=function(){return g=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},g.apply(this,arguments)},b=(0,i.memo)((function(e){var t=e.className,r=e.articleId,a=(0,o.A)("uJIcbC",[t],{}),i=(0,d.v9)(y);return(0,n.jsx)("div",g({className:a},{children:(0,n.jsxs)("div",g({className:"mvU6Vb"},{children:[(0,n.jsx)(j,{text:"go-article-feed"}),i&&(0,n.jsx)(p,{slug:r,text:"go-article-edit"})]}))}))})),N=r(2559);var w=r(6660);var O=function(){return O=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},O.apply(this,arguments)},A=function(){var e=(0,o.A)("vTQ_u3");return(0,n.jsxs)(w.O,O({className:e},{children:[(0,n.jsx)(w.O,{className:"iaJV9q"}),(0,n.jsx)(w.O,{className:"a_FD6P"})]}))},I=function(){return I=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},I.apply(this,arguments)},L=(0,i.memo)((function(e){var t=e.className,r=e.comment,a=e.isLoading,i=r.user,c=(0,o.A)("W4FoWN",[t],{});return(0,n.jsxs)(n.Fragment,{children:[a&&(0,n.jsx)(A,{}),!a&&(0,n.jsx)("div",I({className:c},{children:(0,n.jsxs)("div",I({className:"mFNVZx"},{children:[(null==i?void 0:i.avatar)&&(0,n.jsx)(N.q,{source:i.avatar,title:i.username,className:"Wn7Nr3"}),(0,n.jsx)(m.ud,I({to:"".concat(v.h3.profile).concat(i.id),className:"nCuM76"},{children:i.username})),(0,n.jsx)("div",I({className:"xZucaB"},{children:r.text}))]}))}))]})}));var C=function(){return C=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},C.apply(this,arguments)},P=(0,i.memo)((function(e){var t=e.className,r=e.commentList,a=e.isLoading,i=(0,u.$G)().t,c=(0,o.A)("s1fRCc",[t],{});return(0,n.jsx)("div",C({className:c},{children:(0,n.jsxs)("div",C({className:"ViM6Ug"},{children:[(0,n.jsx)("div",C({className:"HxOswv"},{children:i("comment-title")})),(0,n.jsxs)("div",C({className:"KoEtQX"},{children:[!(null==r?void 0:r.length)&&(0,n.jsx)("div",{children:i("comment-not-exist")}),null==r?void 0:r.map((function(e){return(0,n.jsx)(L,{className:"T3HvTP",comment:e,isLoading:a},e.id)}))]}))]}))}))})),k=r(5346),S=r(2590),E=r(9762),F=r(4305),G=function(e){var t,r;return null!==(r=null===(t=e.commentCreator)||void 0===t?void 0:t.text)&&void 0!==r?r:""},T=function(e){var t;return null===(t=e.commentCreator)||void 0===t?void 0:t.error},M=r(4268),W=(0,M.hg)("commentCreator/addComment",(function(e,t){return r=void 0,n=void 0,i=function(){var r,n,a,i;return function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(o=0)),o;)try{if(r=1,n&&(a=2&c[0]?n.return:c[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,c[1])).done)return a;switch(n=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){o.label=c[1];break}if(6===c[0]&&o.label<a[1]){o.label=a[1],a=c;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(c);break}a[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],n=0}finally{r=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}}(this,(function(o){switch(o.label){case 0:r=t.extra,n=t.rejectWithValue,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,r.api.post("/comments",e)];case 2:if(!(a=o.sent().data))throw new Error("no comment add");return[2,a];case 3:return i=o.sent(),console.log("error",i),[2,n("error-add-comment")];case 4:return[2]}}))},new((a=void 0)||(a=Promise))((function(e,t){function o(e){try{s(i.next(e))}catch(e){t(e)}}function c(e){try{s(i.throw(e))}catch(e){t(e)}}function s(t){var r;t.done?e(t.value):(r=t.value,r instanceof a?r:new a((function(e){e(r)}))).then(o,c)}s((i=i.apply(r,n||[])).next())}));var r,n,a,i})),$=(0,M.oM)({name:"commentCreatorSlice",initialState:{text:"",error:void 0},reducers:{setComment:function(e,t){e.text=t.payload,e.error=void 0}}}),_=$.actions,q=$.reducer;var D=function(){return D=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},D.apply(this,arguments)},R={commentCreator:q},V=(0,i.memo)((function(e){var t=e.className,r=e.userId,a=e.articleId,c=(0,u.$G)().t,s=(0,d.v9)(G),l=(0,d.v9)(T),f=(0,F.T)(),m=(0,i.useCallback)((function(e){f(_.setComment(e))}),[f]),v=(0,i.useCallback)((function(e){e.preventDefault(),f(W({userId:r,articleId:a,text:s}))}),[r,a,s,f]),h=(0,o.A)("iKrHjh",[t],{});return(0,n.jsx)(E.W,D({reducerList:R},{children:(0,n.jsxs)("div",D({className:h},{children:[l&&(0,n.jsx)("div",{children:c("error-in-comment-creator")}),(0,n.jsxs)("form",D({className:"GE5Q_6",onSubmit:v},{children:[(0,n.jsx)(S.II,{className:"yOHAAq",placeholder:c("comment-text"),value:s,onChange:m,name:"comment"}),(0,n.jsx)(k.zx,D({type:"submit",className:"SRPgR9"},{children:c("send-form")}))]}))]}))}))}));var H=function(){return H=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},H.apply(this,arguments)},K=(0,i.memo)((function(e){var t=e.className,r=e.slug,a=e.userId,i=(0,o.A)("DA2Q2r",[t],{});return(0,n.jsx)("div",H({className:i},{children:(0,n.jsx)(V,{articleId:r,userId:a})}))})),Q=r(6763),U=(0,M.hg)("commentList/fetchCommentArticleListById",(function(e,t){return r=void 0,n=void 0,i=function(){var r,n,a;return function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(o=0)),o;)try{if(r=1,n&&(a=2&c[0]?n.return:c[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,c[1])).done)return a;switch(n=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){o.label=c[1];break}if(6===c[0]&&o.label<a[1]){o.label=a[1],a=c;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(c);break}a[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],n=0}finally{r=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}}(this,(function(i){switch(i.label){case 0:r=t.extra,n=t.rejectWithValue,e||n("error"),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,r.api.get("/comments",{params:{articleId:e,_expand:"user"}})];case 2:if(!(a=i.sent()).data)throw new Error;return[2,a.data];case 3:return i.sent(),[2,n("error")];case 4:return[2]}}))},new((a=void 0)||(a=Promise))((function(e,t){function o(e){try{s(i.next(e))}catch(e){t(e)}}function c(e){try{s(i.throw(e))}catch(e){t(e)}}function s(t){var r;t.done?e(t.value):(r=t.value,r instanceof a?r:new a((function(e){e(r)}))).then(o,c)}s((i=i.apply(r,n||[])).next())}));var r,n,a,i})),Z=(0,M.HF)({selectId:function(e){return e.id}}),z=Z.getInitialState({isLoading:!1,error:void 0,ids:[],entities:{}}),J=(0,M.oM)({name:"commentArticleListSlice",initialState:z,reducers:{},extraReducers:function(e){e.addCase(U.pending,(function(e){e.error=void 0,e.isLoading=!0})).addCase(U.fulfilled,(function(e,t){e.isLoading=!1,Z.setAll(e,t.payload)})).addCase(U.rejected,(function(e,t){e.isLoading=!1,e.error=t.payload}))}}).reducer,B=Z.getSelectors((function(e){return e.commentAticleList||Z.getInitialState()})),X=function(e){var t;return null===(t=e.commentAticleList)||void 0===t?void 0:t.error},Y=function(e){var t;return null===(t=e.commentAticleList)||void 0===t?void 0:t.isLoading};var ee=function(){return ee=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},ee.apply(this,arguments)},te={commentAticleList:J},re=(0,i.memo)((function(e){var t=e.className,r=e.slug,a=e.userId,c=(0,u.$G)().t,s=(0,d.v9)(B.selectAll),l=(0,d.v9)(Y),f=(0,d.v9)(X),m=(0,F.T)();(0,i.useEffect)((function(){m(U(r))}),[m,r]);var v=(0,o.A)("i4OBJp",[t],{});return(0,n.jsx)(E.W,ee({reducerList:te,removeAfterUnmount:!0},{children:(0,n.jsxs)("div",ee({className:v},{children:[f&&(0,n.jsx)("div",{children:c("error")}),(0,n.jsx)(Q.Dx,ee({size:Q.Gm.M},{children:c("comment-title")})),(0,n.jsx)(P,{commentList:s,isLoading:l}),a?(0,n.jsx)(K,{slug:r,userId:a}):(0,n.jsx)("div",{children:c("not-registered-user")})]}))}))}));var ne=function(){return ne=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},ne.apply(this,arguments)},ae=(0,i.memo)((function(e){var t=e.className,r=(0,u.$G)().t,i=(0,f.UO)().id,c=(0,d.v9)(l.m5),m=(0,o.A)("zzaIK_",[t],{});return i?(0,n.jsxs)("div",ne({className:m},{children:[(0,n.jsx)(b,{articleId:i}),(0,n.jsx)(a.d2,{articleId:i}),(0,n.jsx)(s,{}),(0,n.jsx)(re,{slug:i,userId:null==c?void 0:c.id})]})):(0,n.jsx)("div",ne({className:m},{children:r("page-not-found")}))}))}}]);